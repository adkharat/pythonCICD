pipeline {

   agent any
   
    // stages {
    //     stage('Test') {
    //         steps {
    //             script { 
    //                 docker.image('node:12.16.2').run('-d -p 3000:3000')  
    //                 } 
    //             sh 'node --version'
    //         }
    //     }
    // }

    // agent any

    stages {

        stage('CleanWorkspace and Clone') {
            steps {
                cleanWs()
                echo 'Workspace cleaned /var/lib/jenkins/workspace'

                checkout scm 
                echo 'Code clone in Workspace /var/lib/jenkins/workspace'

                echo 'Python and Pip version '
                sh 'python3 --version'
                sh 'command -v pip3 || (sudo apt-get update && sudo apt-get install -y python3-pip)'
                sh 'pip3 --version'
            }
        }

        stage('Dependench Installation') {
            steps {
                sh 'pip3 install -r requirements.txt'
            }
        }

        stage('Build') {
            steps {
                sh 'python3 lambda-dunction.py'
            }
        }

    }
 

        // stage("python3 build"){
        //     steps{
        //         // sh 'apt install -y python3-venv'
        //         // sh 'python3 -m venv venv'
        //         // sh 'source venv/bin/activate'
        //         // sh 'which python'
        //         // withPythonEnv('venv/bin/python'){
        //         //     sh("python3 lambda-dunction.py") 
        //         // }
        //         // docker.image("httpd:2.4-alpine").run('-d -p 80:80')
        //     echo 'Done with build'
        //     }
        // }

    //     stage("build"){
    //         steps{
    //             echo 'Generating the Gradle build in build/lib/ folder'
    //             sh "pwd"
    //             sh "ls -la"
    //         }
    //     }
    // }    
}