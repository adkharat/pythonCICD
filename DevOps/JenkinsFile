pipeline {

    agent any

    stages {

        stage('CleanWorkspace and Clone') {
            steps {
                cleanWs()
                echo 'Workspace cleaned /var/lib/jenkins/workspace'

                checkout scm 
                echo 'Code clone in Workspace /var/lib/jenkins/workspace'

                echo 'Python and Pip version '
                sh 'python3 --version'
                // sh 'command -v pip3 || sudo apt-get update && sudo apt-get install -y python3-pip'
                // sh 'pip3 --version'
            }
        }

        stage("python3"){
            steps{
                sh 'python3 -m venv venv'
                sh 'source venv/bin/activate'
                sh 'which python'
                withPythonEnv('/usr/bin/python3.10'){
                    sh("python3 lambda-dunction.py") 
                }
            echo 'Done with build'
            }
        }

        stage("build"){
            steps{
                echo 'Generating the Gradle build in build/lib/ folder'
                sh "pwd"
                sh "ls -la"
            }
        }
    }    
}